---
- name: "Play for localhost"
  hosts: localhost
  connection: local
  become: true
  tasks:
    - name: Update apt repo and cache on
      ansible.builtin.apt:
        update_cache: true
        cache_valid_time: 3600
        upgrade: dist

    - name: Install python packages
      ansible.builtin.pip:
        name:
          - passlib
          - netaddr

    - name: Install apt packages
      ansible.builtin.apt:
        pkg:
          - pinta
          - curl
          - code
          - git
          - brave-browser
          - python3
          - vlc
          - adb
          - exiftool
        autoclean: true
        autoremove: true

    - name: Download latest yq to bin
      ansible.builtin.get_url:
        url: https://github.com/mikefarah/yq/releases/latest/download/yq_linux_amd64
        dest: /usr/local/bin/yq
        mode: a+x

# - name: "Play for k3s kube config"
#   hosts: localhost
#   connection: local
#   become: true
#   become_user: coen
#   tasks:
#     - name: Replace localhost ip to apiserver endpoint in kube config file
#       ansible.builtin.lineinfile:
#         path: "~/.kube/config"
#         search_string: "    server: https://127.0.0.1:6443"
#         line: "    server: https://{{ hostvars[groups['k3s_cluster'][0]].apiserver_endpoint }}:6443"
#         state: present
